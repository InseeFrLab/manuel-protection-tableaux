{
  "hash": "cd10d76f9862251859e46edcc109bedf",
  "result": {
    "markdown": "# Comment analyser une demande ? {#sec-analyserdemande}\n\nLa liste de tableaux à diffuser n'est pas la même que la liste des tableaux à protéger. En effet, la liste de tableaux à protéger découle d'une analyse des liens entre les différents tableaux. Cette partie a pour but de présenter le cadre de réflexion et les étapes suivies par la DMRG pour définir la liste de tableaux sur lesquels le masque de secret sera posé.\n\n## Étapes de l'analyse de demande\n\n::: callout-tip\n## Etapes de l'analyse de la demande\n\n1.  Réunir les informations nécessaires à la gestion de la confidentialité\n2.  Séparer la demande en sous-demande indépendantes si possible\n3.  Détecter les liens\n4.  Construire les hiérarchies éventuellement nécessaires\n5.  Lister les tableaux nécessaires pour la pose de secret (passage de la liste de diffusion à la liste de protection).\n:::\n\n### Vérifier que toutes les informations nécessaires à la gestion de la confidentialité sont disponibles\n\nLes informations nécessaires sont :\n\n-   Les règles de secret qui s'appliquent sur les données (voir [Annexes](#sec-regles))\n\n-   Une description précise des tableaux que votre interlocuteur souhaite diffuser :\n\n    -   sur quel champ de la population les tableaux sont-ils construits ?\n    -   quelles sont les variables descriptives (de croisement) ?\n    -   quelle est la variable de réponse pour chacun des tableaux ?\n    -   les tableaux sont-ils des tableaux de fréquence ou bien des tableaux de volume ?\n    -   parmi l'ensemble des variables de croisement, certaines sont-elles hiérarchiques ? Les emboîtements ont-ils été fournis ?\n\n-   Une description précise des liens éventuels entre les variables ou tableaux :\n\n    -   certaines variables ou modalités sont-elles reliées par une équation ?\n    -   des équations/liens ont-ils été fournis ?\n    -   de fortes corrélations existent-elles entre certaines variables de réponse ?\n\n### La demande peut-elle être séparée en plusieurs sous-demandes indépendantes ?\n\n-   Des tableaux portant sur des variable de réponse différentes, non liées par une équation ou par un lien de corrélation fort, peuvent être traités séparément.\n\n-   Des tableaux construits sur des champs différents et non complémentaires peuvent être traités séparément.\n\n-   Y a-t-il au contraire des tableaux qui doivent être traités dans dans le même temps ?\n\n    -   rassembler les tableaux partageant la même variable de réponse et le même champ, car ils partagent a minima le même super-total (n.b. on ne les fusionne pas on les rassemblent juste pour les traiter ensemble)\n    -   déterminer les tableaux liés entre eux par leurs marges\n    -   déterminer les tableaux liés entre eux car \"additifs\"\n    -   déterminer les tableaux liés entre eux par la présence potentielle de hiérarchies non-emboîtées\n\nChaque sous-demande doit faire l'objet d'un traitement à part, en suivant les mêmes étapes.\n\n### Détecter les liens\n\nIl y a deux principaux types de liens sur les variables réponse :\n\n-   les hiérarchies\n\n    -   emboîtées (voir [Notions](#sec-hrc))\n    -   non-emboîtées (voir [Notions](#sec-hrcnonemb))\n\n-   les équations du type A = B + C\n\n    -   entre les variables réponses\n    -   au niveau des champs\n    \nEn présence de tels liens il faut parfois regrouper des tableaux en un seul (hiérarchie emboîtée sur une variable de croisement), ou au contraire construire deux tableaux à partir d'un seul (hiérarchie non-emboîtée). Dans tous les cas lorsque des tableaux sont liés il faut les traiter ensemble afin que lorsqu'une cellule est touchée dans un tableau, elle \nle soit aussi automatiquement dans tous les autres tableaux où elle apparaît.\n\n### Passer de la liste de diffusion à la liste de protection\n\nLa liste de diffusion est la liste de tableaux qui sera effectivement publiée. Elle diffère de la liste de protection qui elle est à établir en fonction des liens entre les différents tableaux. En effet, pour poser le secret pertinemment il faut renseigner les différents liens pour que l'algorithme en tienne compte.\n\nPar exemple on peut être amené à :\n\n-   Rassembler en un seul tableau les tableaux liés car \"additifs\".\n-   Séparer en plusieurs tableaux un tableau qui contiendrait des sous-totaux non-emboîtés.\n\nDe plus, si les données sont sous forme de micro-données il faut calculer les agrégats qui seront diffusés pour établir la liste de diffusion. En effet, nous ne posons pas le secret sur les micro-données mais sur les agrégats. Pour ce faire la fonction `tabul_fun_group` permet de facilement construire les tables agrégées sous le bon format pour les mettre en entrée de `rtauargus`.\n\n## Fiches exemples d'analyse de demandes\n\n### Exemple 1 : niveau facile\n\n**Demande** - on souhaite diffuser 4 tableaux\n\n-   T1 : population par âge (5 classes), par sexe et par département\n-   T2 : population par sexe, par diplôme et par département\n-   T3 : population par catégorie catégorie socio-professionnelle, par statut d'activité et par département\n-   T4 : population par âge, par sexe et par statut d'activité\n\nEn formalisant :\n\n-   T1 : pop x {age x sexe x dep}\n-   T2 : pop x {sexe x dip x dep}\n-   T3 : pop x {socpro x act x dep}\n-   T4 : pop x {age x sexe x act}\n\n**Analyse**\n\nLes tableaux partagent le même champ (sous-entendu) et le même indicateur (population), ils sont donc liés a minima par le total, donc il n'y a pas de sous-demande indépendante.\n\nDe plus, certains tableaux ont des variables de croisement communes, il y a un lien sur les marges, les liens n'en sont que renforcés.\n\nLes variables entre elles n'ont pas de lien hiérarchique (le seul niveau géographique est le département), donc les tableaux ne doivent pas être fusionnés.\n\nFinalement, la liste des tableaux à protéger est identique à la liste des tableaux à diffuser.\n\n### Exemple 2 : niveau moyen\n\n**Demande** - on souhaite diffuser 7 tableaux\n\n-   T1 : population par âge (5 classes), par sexe et par département\n-   T2 : population par sexe, par diplôme et par département\n-   T3 : population par catégorie catégorie socio-professionnelle, par statut d'activité et par département\n-   T4 : population par âge, par sexe et par statut d'activité\n-   T5 : population par âge (5 classes), par sexe et par région\n-   T6 : population par sexe, par diplôme et par région\n-   T7 : population par catégorie socio-professionnelle, par statut d'activité et par région\n\nEn formalisant :\n\n-   T1 : pop x {age x sexe x dep}\n-   T2 : pop x {age x dip x dep}\n-   T3 : pop x {socpro x act x dep}\n-   T4 : pop x {age x sexe x act}\n-   T5 : pop x {age x sexe x reg}\n-   T6 : pop x {sexe x dip x reg}\n-   T7 : pop x {socpro x act x reg}\n\n**Analyse**\n\nLes tableaux partagent le même champ (sous-entendu) et le même indicateur (population), ils sont donc liés a minima par le total, donc il n'y a pas de sous-demande indépendante.\n\nDe plus, certains tableaux ont des variables de croisement communes, il y a un lien sur les marges, les liens n'en sont que renforcés.\n\nDeux variables ont un lien hiérarchique (région \\> département), lorsque l'information est hiérarchisée (et emboîtée) il faut la traiter dans un même tableau en créant une variable hiérarchique qu'on peut appeler par exemple `GEO`. De plus, on peut fusionner les tableaux partageant les mêmes variables de croisement.\n\nLa liste des tableaux à protéger est donc la suivante :\n\n-   T1 : pop x {age x sexe x GEO}\n-   T2 : pop x {sexe x dip x GEO}\n-   T3 : pop x {socpro x act x GEO}\n-   T4 : pop x {age x sexe x act}\n-   où GEO est une variable hiérarchique emboîtant régions et départements\n\n### Exemple 3 : niveau expert\n\n**Demande** - on souhaite diffuser 4 tableaux\n\n-   T1 : population par âge (3 classes : \\<25, 25-55, +55) et par département\n-   T2 : population par âge (5 classes : \\<15, 15-25, 25-45, 45-65, +65), par sexe et par département\n-   T3 : population par âge (3 classes : \\<25, 25-55, +55) et par région\n-   T4 : population par âge (5 classes : \\<15, 15-25, 25-45, 45-65, +65), par sexe et par région\n\nEn formalisant :\n\n-   T1 : pop x {age_3 x dep}\n-   T2 : pop x {age_5 x sexe x dep}\n-   T3 : pop x {age_3 x reg}\n-   T4 : pop x {age_5 x sexe x reg}\n\n**Analyse**\n\nLes tableaux partagent le même champ (sous-entendu) et le même indicateur (population), ils sont donc liés a minima par le total, donc il n'y a pas de sous-demande indépendante.\n\nDe plus, certains tableaux ont des variables de croisement communes, il y a un lien sur les marges, les liens n'en sont que renforcés.\n\nDeux variables ont un lien hiérarchique (région \\> département) :\n\n-   les tableaux T1 et T3 partagent les mêmes variables de croisement et peuvent donc être fusionnés\n-   les tableaux T2 et T4 partagent les mêmes variables de croisement et peuvent donc être fusionnés\n\nLa variable âge est ventilée différemment entre T1 et T2 (ainsi qu'entre T3 et T4). On doit donc se demander si les différentes modalités de l'âge sont emboîtées. On peut présenter la hiérarchie ainsi :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n<25\n@<15\n@15-25\n25-55\n@25-45\n@45-55\n+55\n@55-65\n+65\n```\n:::\n\n\nIl n'est pas possible d'insérer la modalité 45-65 dans cette hiérarchie, il s'agit donc d'un cas de hiérarchie non-emboîtée. En effet, 45-65 = 45-55 + 55-65 est un agrégat non-emboîté qui devra être traité en construisant un tableau séparé.\n\nUne première étape d'analyse mène à la liste des tableaux à protéger suivante :\n\n-   T1 : pop x {AGE_hrc_princ x GEO}\n-   T1bis : pop x {AGE_hrc_spe x GEO}\n-   T2 : pop x {AGE_hrc_princ x sexe x GEO}\n-   T2bis : pop x {AGE_hrc_spe x sexe x GEO}\n-   où GEO est une variable hiérarchique emboîtant régions et départements\n-   où AGE_hrc_princ (hiérarchie principale) est une variable hiérarchique emboîtant l'ensemble des catégories d'âge hors 45-65\n-   où AGE_hrc_spe (agrégat spécial) a les modalités : 45-65 = 45-55 + 55-65\n\nOn remarque que T1 est en réalité déjà \"contenu\" dans T2. Puisque le croisement AGE_hrc_princ x GEO est présente dans T2. De même T1bis est contenu dans T2bis. On peut donc regrouper ces tableau. Finalement, on se retrouve avec cette liste de tableaux à protéger :\n\n-   T1 : pop x {AGE_hrc_princ x sexe x GEO}\n-   T2 : pop x {AGE_hrc_spe x sexe x GEO}\n-   où GEO est une variable hiérarchique emboîtant régions et départements\n-   où AGE_hrc_princ (hiérarchie principale) est une variable hiérarchique emboîtant l'ensemble des catégories d'âge hors 45-65\n-   où AGE_hrc_spe (agrégat spécial) a les modalités : 45-65 = 45-55 + 55-65\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}